line 299, 301, 305 added